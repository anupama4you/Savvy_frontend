<apex:page docType="html-5.0" standardController="Custom_Opportunity__c" extensions="ACLCalculatorExtension" sidebar="false" showHeader="true" id="LatitudeCalc">
    <apex:variable value="{!Custom_Opportunity__c}" var="o" />
    <!-- Partner Portal Styles -->
    <apex:outputPanel rendered="{!isBrokerPartnerUser}">
      <style type="text/css">
        html .brandQuaternaryBgr,
        .titleDiv {
          background: #ffffff !important;
        }
    
        .bPageBlock {
          border: 1px solid white !important;
        }
      </style>
    </apex:outputPanel>
    <apex:stylesheet value="{! $Resource.QuotingCalculatorCSS }"/>
    <style type="text/css">
        .calcInput2 {
            border: 1px solid #e0e0e0;
            padding: 0.15em;
            max-width: 70px;
        }
        .titleDiv {
            width: 100%;
            height: 43px;
            font-size: 1.0rem;
        }
        .logo { 
            float: right;
            width: 60%;
        }
        .calculatorInput {
            padding-bottom: 20px;
            background: #f8f8f8;
            border: 1px solid #ddd;
        }
        .divTitle {
            background-color: #ddd;
            padding-top: 2px;
            padding-bottom: 2px;
            padding-left: 20px;
            text-transform: uppercase;
            border: 1px solid #ddd;
        }
        .leftTables {
            display: inline-block;
            float: left;
            width: 28%;
            padding-left: 20px;
        }
        #rightTables {
            display: inline-block;
            width: 70%;
        }
        #vehicleTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
        }
        #vehicleDetails {
        width: 95%;
        background: white;
        border: 1px solid #ddd;
        margin-top: 15px;
        padding: 2px;
        padding-left: 20px;
        padding-top: 10px;
        padding-bottom: 10px;
        }
        #insuranceTab {
        border: 1px solid #ddd;
        border-bottom: transparent;
        display: inline-block;
        background-color: #fff;
        position: relative;
        padding: 6px;
        top: 17px;
        }
        #insuranceProduct {
        width: 95%;
        background: white;
        border: 1px solid #ddd;
        margin-top: 15px;
        padding: 2px;
        padding-left: 20px;
        padding-top: 0px;
        padding-bottom: 10px;
        }
        #financeTab {
        border: 1px solid #ddd;
        border-bottom: transparent;
        display: inline-block;
        background-color: #fff;
        position:relative;
        padding: 6px;
        top: 17px;
        }
        #financeDetails {
        width: 95%;
        background: white;
        border: 1px solid #ddd;
        margin-top: 15px;
        padding: 2px;
        padding-left: 20px;
        padding-top: 10px;
        padding-bottom: 10px;
        }
        #commissionPanel {
        background: #f8f8f8;
        border: 1px solid #ddd;
        }
        #commissionTab {
        border: 1px solid #ddd;
        border-bottom: transparent;
        display: inline-block;
        background-color: #fff;
        position: relative;
        padding: 6px;
        top: 17px;
        margin-left: 20px;
        }
        #commission {
        width: 96%;
        background: white;
        border: 1px solid #ddd;
        margin-top: 15px;
        padding: 2px;
        padding-left: 20px;
        padding-top: 20px;
        padding-bottom: 20px;
        margin-left: 20px;
        margin-bottom: 20px;
        }
        #repaymentPanel {
        background: #f8f8f8;
        border: 1px solid #ddd;
        }
        #repaymentTab {
        border: 1px solid #ddd;
        border-bottom: transparent;
        display: inline-block;
        background-color: #fff;
        position: relative;
        padding: 6px;
        top: 17px;
        margin-left: 20px;
        }
        #repayment {
        width: 96%;
        background: white;
        border: 1px solid #ddd;
        margin-top: 15px;
        padding: 2px;
        padding-left: 20px;
        padding-top: 20px;
        padding-bottom: 20px;
        margin-left: 20px;
        margin-bottom: 20px;
        }
        .inTableTitle {
        font-weight: bold;
        padding-top: 10px;
        padding-bottom: 10px;
        }
        .calcInput {
        border: 1px solid #e0e0e0;
        padding: 0.15em;
        min-width: 173px;
        }
        .selectList {
        border: 1px solid #e0e0e0;
        padding: 0.15em;
        width:182px;
        }
        .defaultInsurance {
        text-align: center;
        width: 25%;
        }
        .vehicleColumn {
        width: 25%;
        }
        .insuranceColumn {
        width: 25%;
        }
        .financeColumn {
        width: 50%;
        }
        .commissionLabel {
        width: 8%;
        font-weight: bold;
        }
        .commissionCotent {
        width: 17%;
        font-weight: bold;
        }
        .repayColumn {
        width: 12.5%;
        font-weight: bold;
        }
        .calcLabel {
        font-weight: 500;
        }
        .baseRateColumn {
        padding: 0.3rem;
        }
        .monthlyFeeLabel {
        width: 5%;
        font-weight: bold;
        }
        .monthlyFeeContent {
        width: 20%;
        font-weight: bold;
        }
        .referenceTable {
        
        }
        .referenceTitle {
        padding: 7px;
        }
        .tableDetails {
        width: 95%;
        background: white;
        border: 1px solid #ddd;
        margin-top: 4px;
        padding: 2px;
        padding-left: 20px;
        padding-right: 10px;
        padding-top: 10px;
        padding-bottom: 10px;
        }
        .titleTableTab {
        border: 1px solid #ddd;
        border-bottom: transparent;
        display: inline-block;
        background-color: #fff;
        position: relative;
        padding: 6px;
        top: 17px;
        }
        .resultValue {
        font-weight: bold;
        }
        .buttonPanel {
        float: right;
        text-align: right;
        }
        
        /*Created By: Phil Fang | Date: March 6, 2017 | Description: Styling for ERIC API integration*/
        .acceptQuoteButtons {
        padding: 6px 7px !important;
        color: #fff !important;
        font-size: 11px !important;
        outline: none !important;
        
        background: rgb(125,126,125) !important; 
        background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important;
        
        background: -webkit-linear-gradient(top,  rgba(0,77,0,1) 0%,rgba(0,102,0,1) 100%) !important;
        
        /*original*/
        /*background: -webkit-linear-gradient(top,  rgba(51,126,88,1) 0%,rgba(44,112,66,1) 100%) !important;*/
        
        /*background: -webkit-linear-gradient(top,  rgba(62,151,106,1) 0%,rgba(51,125,88,1) 100%) !important;*/
        
        margin: 0px !important;
        }
        
        .acceptQuoteButtonsClicked {
        padding: 6px 7px !important;
        color: #fff !important;
        font-size: 11px !important;
        outline: none !important;
        
        background: rgb(125,126,125) !important; 
        background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important;
        
        background: -webkit-linear-gradient(top,  rgba(0,153,0,1) 0%,rgba(0,179,0,1) 100%) !important;
        
        /*background: -webkit-linear-gradient(top,  rgba(62,151,106,1) 0%,rgba(51,125,88,1) 100%) !important;*/
        
        margin: 0px !important;
        }
        
        .decQuoteButtons {
        padding: 6px 7px !important;
        color: #fff !important;
        font-size: 11px !important;
        outline: none !important;
        
        background: rgb(125,126,125) !important;
        background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important; 
        
        background: -webkit-linear-gradient(top,  rgba(168,0,0,1) 0%, rgba(219,0,0,1) 100%) !important; Chrome10-25,Safari5.1-6
        
        /*background: -webkit-linear-gradient(top,  rgba(235,74,93,1) 0%, rgba(203,57,74,1) 100%) !important; Chrome10-25,Safari5.1-6*/
        
        /*background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important;  */
        /* filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important;  */
        
        margin: 0px !important;
        }
        
        .decQuoteButtonsClicked {
        padding: 6px 7px !important;
        color: #fff !important;
        font-size: 11px !important;
        outline: none !important;
        
        background: rgb(125,126,125) !important;
        background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important; 
        
        background: -webkit-linear-gradient(top,  rgba(245,0,0,1) 0%, rgba(255,66,66,1) 100%) !important; Chrome10-25,Safari5.1-6
        
        /*background: -webkit-linear-gradient(top,  rgba(235,74,93,1) 0%, rgba(203,57,74,1) 100%) !important; Chrome10-25,Safari5.1-6*/
        
        /*background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important;  */
        /* filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important;  */
        
        margin: 0px !important;
        }
        
        .buyPolicyButtons {
        padding: 6px 7px !important;
        color: #fff !important;
        font-size: 14px !important;
        outline: none !important;
        
        background: rgb(125,126,125) !important;
        background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important; 
        
        background: -webkit-linear-gradient(top,  rgba(0,0,0,1) 0%, rgba(191,191,191,1) 100%) !important; Chrome10-25,Safari5.1-6
        
        
        /*color test 2 okay*/
        /*background: -webkit-linear-gradient(top,  rgba(66,161,255,1) 0%, rgba(117,186,255,1) 100%) !important; Chrome10-25,Safari5.1-6*/
        
        /*original*/
        /*background: -webkit-linear-gradient(top,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important;*/
        background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important; 
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important; 
        
        float: right;
        margin-top: 10px !important;
        margin-right: 48px !important;
        height:45px;
        width: 150px;
        
        }
        .main-content {
          margin-left: auto;
          width: 86%;
        }
    </style>
    
    <c:sidebarV2 oppId="{!o.Id}" appId="{!o.Application__c}" showLenders="true" rendered="{!NOT(isBrokerPartnerUser)}" />
    
    <div id="mainContent" class="{!IF(NOT(isBrokerPartnerUser),'main-content','')}">
        <apex:form id="calcFormData">
          <apex:pageMessages id="pageMessage" />
          <!-- NWC -->
          <apex:actionFunction action="{!nationalWarrantyCalc}" name="nationalWarrantyCalc" reRender="realtimeNaf, netDeposit, pnlInsProd, pageMessage"
            oncomplete="nafRefresh()" />
          <!-- HJ - NWC Calculator - 11-07-2018 - I -->
          <!-- <apex:actionFunction action="{!calculateNWC}" name="calculateNWC" reRender="listTypeNWC, fldNwcCost, NWCMessage, NWCRetailPrice, NWCComission, realtimeNaf, netDeposit, pnlInsProd, pageMessage, NwcPriceToCustomer, messageNWCWarning,nwcIncome_input, nwc_input, nwcTerm2, NWCPayment" oncomplete="nafRefresh()" status="stsProd"/>
                      <apex:actionFunction action="{!checkManuallyNWCPrice}" name="checkManuallyNWCPrice" reRender="listTypeNWC, fldNwcCost, NWCMessage, NWCRetailPrice, NWCComission, realtimeNaf, netDeposit, pnlInsProd, pageMessage, NwcPriceToCustomer,nwcIncome_input, nwc_input" status="stsProd"/> -->
          <apex:actionFunction action="{!calculateNWC}" name="calculateNWC" reRender="pnlNwc, NWCRetailPrice, NWCComission, pageMessage, nwcIncome_input, nwc_input, nwcTerm2, NWCPayment"
            oncomplete="nafRefresh()" status="stsProd" />
          <apex:actionFunction action="{!checkManuallyNWCPrice}" name="checkManuallyNWCPrice" reRender="pnlNwc, NWCRetailPrice, NWCComission, pageMessage, nwcIncome_input, nwc_input, nwcTerm2, NWCPayment"
            status="stsProd" />
          <!-- HJ - NWC Calculator - 11-07-2018 - F -->
          <apex:actionFunction action="{!sendCustomerEmail1}" name="sendCustomerEmail1" reRender="pageMessage" status="stsSend1" oncomplete="sendCustomerEmail2();"/>
          <apex:actionFunction action="{!sendCustomerEmail2}" name="sendCustomerEmail2" status="stsSend2" reRender="pageMessage"/>
          <apex:actionFunction name="nafRefresh" reRender="realtimeNaf,netDeposit" />
          <apex:actionFunction action="{!calcRiskFee}" name="calcRiskFee" reRender="riskFee, minRate, maxRate, clientRate, maxApplicationFee, riskFeeInput" status="stsRiskFee"/>
          
          <div class="titleDiv">
            <h1>Affordable Car Loans for {!Custom_Opportunity__c.Name}</h1>
            <div class="buttonPanel">
              <table>
                <tr>
                  <td>
                    <apex:actionStatus startText="(Processing...)" id="stsQuote" />
                    <apex:actionStatus startText="(Saving...)" id="stsSend1" />
                    <apex:actionStatus startText="(Sending...)" id="stsSend2" />&nbsp;&nbsp;&nbsp;
                    
                    <apex:commandButton styleClass="calculateButtons" value="Calculate" action="{!calculate}" status="stsQuote" reRender="calcFormData"/>
                    <apex:commandButton styleClass="calculateButtons" value="Reset" action="{!reset}" status="stsQuote" reRender="calcFormData"/>
                    <apex:commandButton styleClass="calculateButtons" value="Save Quoting" action="{!saveQuoting}" status="stsQuote" reRender="calcFormData"/>
                    <apex:commandButton styleClass="calculateButtons" value="Save Pre-approval" action="{!savePreApproval}" status="stsQuote" reRender="calcFormData"/>
                    <apex:commandButton styleClass="calculateButtons" value="Save Amendment" action="{!saveAmendment}" status="stsQuote" reRender="calcFormData"/>
                    <apex:commandButton styleClass="calculateButtons" value="Save Formal Approval" action="{!saveFormalApproval}" status="stsQuote" reRender="calcFormData"/>
                    
                    <input name="DoAction" type="button" value="Send Quote" class="btn calculateButtons" onclick="sendCustomerEmail1();return false;"/>
                  </td>
                  <td>
                    <apex:image url="{!$Resource.ACLLogo}" height="40" />
                  </td>
                </tr>
              </table>
            </div>
          </div>
          <div class="calculatorInput">
              <div class="divTitle"><h3>Input</h3></div>
              <div style="display: flex;">
                <apex:outputPanel layout="block" id="leftTables" styleClass="leftTables">
                  <div id="financeTab"><h3>Finance Details</h3></div>
                  <table id="financeDetails">
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Loan Type" for="LoanType" />
                        </td>
                        <td class="financeColumn">
                            <apex:selectList label="Loan Type" value="{!loanType}" multiselect="false" size="1" styleClass="selectList" id="LoanType">
                                <apex:selectOptions value="{!qh.loanTypeOptions}" />
                            </apex:selectList>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Loan Product" for="productLoanType" />
                        </td>
                        <td class="financeColumn">
                            <apex:selectList label="Loan Type" value="{!productLoanType}" multiselect="false" size="1" styleClass="selectList" id="productLoanType">
                                <apex:selectOption itemLabel="Consumer Loan" itemValue="Consumer Loan" />
                            </apex:selectList>
                        </td>
                    </tr>
                    <!--<tr>
                      <td class="financeColumn">
                        <apex:outputLabel styleClass="calcLabel" value="Client Tier" for="clientTier" />
                      </td>
                      <td class="financeColumn">
                        <apex:selectList label="Loan Type" value="{!clientTier}" multiselect="false" size="1" styleClass="selectList" id="clientTier" onchange="calcRiskFee()">
                          <apex:selectOptions value="{!clientTierOptions}" />
                        </apex:selectList>
                      </td>
                    </tr>-->
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel style="display:inline-block;" value="Credit Score" for="creditScore" />
                        </td>
                        <td class="financeColumn">
                            <!-- <apex:selectList label="Loan Type" value="{!creditScore}" multiselect="false" size="1" styleClass="selectList" id="LoanCreditScore">
                                <apex:selectOptions value="{!loanCreditScoreOptions}" />
                            </apex:selectList> -->
                            <!--<apex:input value="{!creditScore}" id="LoanCreditScore" styleClass="calcInput2">
                              <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee, dof, riskFee, riskFeeInput, realtimeNaf"
                                status="stsAppFeeCalc" />
                            </apex:input>-->
                          <apex:selectList value="{!creditScore}" multiselect="false" size="1" styleClass="selectList" id="LoanCreditScore">
                            <apex:selectOption itemLabel="--None--" itemValue="" />
                            <apex:selectOption itemLabel="500+" itemValue="500+" />
                            <apex:selectOption itemLabel="400-499" itemValue="400-499" />
                            <apex:selectOption itemLabel="300-399" itemValue="300-399" />
                            <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee, dof, riskFee, riskFeeInput, realtimeNaf, minRate, maxRate" status="stsAppFeeCalc"/>
                          </apex:selectList>
                        </td>
                    </tr>
                    <tr>
                        <td>Vehicle Year</td>
                        <td>
                            <apex:selectList value="{!year}" multiselect="false" size="1" styleClass="selectList" id="fldYear" onchange="calcRiskFee()">
                                <apex:selectOptions value="{!yearsSelect}" />
                            </apex:selectList>&nbsp;&nbsp;&nbsp;
                            <apex:actionStatus startText="   (loading...)" id="stsYear"  />
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Vehicle Price" for="carPrice" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" value="{!carPrice}" html-placeholder="$" id="carPrice" styleClass="calcInput">
                                <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee, dof, riskFee, riskFeeInput, realtimeNaf" status="stsAppFeeCalc"/>
                            </apex:input>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Deposit" for="deposit" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Deposit" value="{!deposit}" html-placeholder="$" id="deposit" styleClass="calcInput">
                                <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee,dof,riskFee, riskFeeInput,netDeposit,realtimeNaf" status="stsAppFeeCalc"/>
                            </apex:input>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Trade In" for="tradeIn" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Trade In" value="{!tradeIn}" html-placeholder="$" id="tradeIn" styleClass="calcInput">
                                <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee,dof,riskFee, riskFeeInput,netDeposit,realtimeNaf" status="stsAppFeeCalc"/>
                            </apex:input>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Payout On Trade In" for="payoutOn" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Payout On" value="{!payoutOn}" html-placeholder="$" id="payoutOn" styleClass="calcInput">
                                <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee,dof,riskFee,riskFeeInput,netDeposit,realtimeNaf" status="stsAppFeeCalc"/>
                            </apex:input>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Net Deposit" for="netDeposit" />
                        </td>
                        <td class="financeColumn">
                            <apex:outputText label="NAF" value="{0, number, $##,###,##0.00}" id="netDeposit" >
                                <apex:param value="{!netDepositVal}" />
                            </apex:outputText>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Application Fee" for="applicationFee" />
                        </td>
                        <td class="financeColumn">
                            <apex:outputPanel id="applicationFee" layout="block">
                                <apex:input type="number" html-step="0.01" value="{!applicationFee}" html-placeholder="$" styleClass="calcInput2" onchange="nafRefresh()" />
                                &nbsp;&nbsp;&nbsp;
                                <apex:outputText value="Max. {0, number, $##,###,##0.00}" id="maxApplicationFee">
                                    <apex:param value="{!maxApplicationFee}"/>
                                </apex:outputText>
                            </apex:outputPanel>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="DOF" for="dof" />
                        </td>
                        <td class="financeColumn">
                            <apex:outputPanel id="dof" layout="block">
                                <apex:input type="number" html-step="0.01" label="DOF" value="{!dof}" html-placeholder="$" styleClass="calcInput2" onchange="nafRefresh()" />
                                &nbsp;&nbsp;&nbsp;
                                <apex:outputText value="Max. {0, number, $##,###,##0.00}">
                                    <apex:param value="{!maxDof}"/>
                                </apex:outputText>
                            </apex:outputPanel>
                            <apex:actionStatus startText="(calculating...)" id="stsAppFeeCalc" />
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="PPSR" for="ppsr" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="PPSR" value="{!ppsr}" html-placeholder="$" id="ppsr" styleClass="calcInput" onchange="nafRefresh()" />
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Residual Value" for="residualValue" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Residual Value" value="{!residualValue}" html-placeholder="$" id="residualValue" styleClass="calcInput" />
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel style="display:inline-block;" value="Monthly Fee" for="monthlyFee" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Monthly Fee" value="{!monthlyFee}" html-placeholder="$" id="monthlyFee" styleClass="calcInput"/>
                        </td>
                    </tr>
                    <tr>
                        <td class="inTableTitle">Loan Details</td>
                        <td class="financeColumn"></td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Term (months)" for="term" />
                        </td>
                        <td class="financeColumn">
                            <apex:selectList label="Loan Repayment" value="{!term}" multiselect="false" size="1" styleClass="selectList" id="LoanTerm" onchange="calcRiskFee()">
                                <apex:selectOptions value="{!loanTermOptions}" />
                            </apex:selectList>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel style="display:inline-block;" value="Repayment" for="creditScore" />
                        </td>
                        <td class="financeColumn">
                            <apex:selectList label="Loan Repayment" value="{!repayment}" multiselect="false" size="1" styleClass="selectList" id="LoanRepayment">
                                <apex:selectOptions value="{!loanRepaymentOptions}" />
                            </apex:selectList>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Payment" for="paymentType" />
                        </td>
                        <td class="financeColumn">
                            <apex:selectList label="Payment" value="{!paymentType}" multiselect="false" size="1" styleClass="selectList" id="paymentType" onchange="messageRefresh()">
                                <apex:selectOptions value="{!qh.selectPaymentTypeOptions}" />
                            </apex:selectList>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Max Rate" for="maxRate" />
                        </td>
                        <td class="baseRateColumn">
                            <apex:outputText value="{0, number, ##,###,##0.00%}" id="maxRate" >
                                <apex:param value="{!maxRate/100}" />
                            </apex:outputText>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Base Rate" for="minRate" />
                        </td>
                        <td class="baseRateColumn">
                            <apex:outputText value="{0, number, ##,###,##0.00%}" id="minRate" >
                                <apex:param value="{!baseRate/100}" />
                            </apex:outputText>
                        </td> 
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Client Rate" for="clientRate" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Client Rate" value="{!clientRate}" html-placeholder="%" id="clientRate" styleClass="calcInput" >
                              <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee, dof, riskFee, riskFeeInput" status="stsRiskFee"/>
                            </apex:input>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="Risk Fee" for="riskFee" />
                             &nbsp;&nbsp;&nbsp;
                            <apex:actionStatus startText="   (calculating...)" id="stsRiskFee" />
                        </td>
                        <td>
                            <apex:outputPanel layout="block">
                                <apex:input type="number" value="{!riskFee}" html-placeholder="$" styleClass="calcInput2" id="riskFeeInput">
                                  <apex:actionSupport event="onchange" action="{!calcRiskFee}" reRender="applicationFee, dof, riskFee, riskFeeInput, realtimeNaf" status="stsAppFeeCalc"/>
                                </apex:input>
                                &nbsp;&nbsp;&nbsp;
                                <apex:outputText value="Calc. {0, number, $##,###,##0.00}" id="riskFee">
                                    <apex:param value="{!riskFeeTotal}"/>
                                </apex:outputText>
                            </apex:outputPanel>
                        </td>
                    </tr>
                    <tr>
                        <td class="financeColumn">
                            <apex:outputLabel styleClass="calcLabel" value="NAF" for="realtimeNaf" />
                        </td>
                        <td class="baseRateColumn">
                            <apex:outputText label="NAF" value="{0, number, $##,###,##0.00}" id="realtimeNaf" >
                                <apex:param value="{!realtimeNaf}" />
                            </apex:outputText>
                        </td>
                    </tr>
                    <!-- <tr>
                        <td class="financeColumn">
                            <apex:outputLabel style="display:inline-block;" value="Bonus" for="calcBonus" />
                        </td>
                        <td class="financeColumn">
                            <apex:input type="number" html-step="0.01" label="Bonus" value="{!calcBonus}" html-placeholder="$" id="calcBonus" styleClass="calcInput2"/>
                            <a href="{!documentid}" target="_blank">Calculate Bonus</a>
                        </td>
                    </tr> -->
                    <tr>
                      <td class="financeColumn">
                          <apex:outputLabel style="display:inline-block;" value="Commission Type" for="commType" />
                      </td>
                      <td class="financeColumn">
                          <apex:selectList value="{!commType}" multiselect="false" size="1" styleClass="selectList" id="commType">
                            <apex:selectOption itemLabel="Calculated" itemValue="Calculated" />
                            <apex:selectOption itemLabel="Manual" itemValue="Manual" />
                            <apex:actionSupport event="onchange" action="{!resetCommissionPayable}" reRender="leftTables" status="stsCommType"/>
                          </apex:selectList>
                          &nbsp;&nbsp;
                          <apex:actionStatus startText="(processing...)" id="stsCommType"  />
                      </td>
                    </tr>
                    <tr>
                      <td class="financeColumn">
                          <apex:outputLabel styleClass="calcLabel" value="Commission Payable" for="commPayable" rendered="{!commType=='Manual'}" id="lblCommPayable" />
                      </td>
                      <td>
                          <apex:outputPanel layout="block" rendered="{!commType=='Manual'}" id="pnlCommPayable">
                            <apex:input type="number" value="{!commPayable}" html-placeholder="$" styleClass="calcInput2" id="commPayable" />
                          </apex:outputPanel>
                      </td>
                    </tr>
                  </table>
                </apex:outputPanel>
                <div id="rightTables">
                    <c:QuotingCommissionResults qext="{!quotingExt}" />
                    <c:InsuranceProductForm qext="{!quotingExt}" formId="calcFormData" id="pnlInsProd" />
                    <br/>
                    <c:ProtectionQuestions lead="{!o.Lead__r}"/>
                    <p>&nbsp;</p>
                    <!-- end Insurance Implementation -->                
                </div>
              </div>
            </div>
        </apex:form>
        <apex:form id="interestForm" >
            <table width="100%" class="tableDetails">
                <tr>
                  <td align="center" class="otherOtherResultValue">Interest Rate Table</td>
                </tr>
                <tr>
                  <td>
                    <table width="100%">
                      <tr>
                        <td align="center" class="resultHeading">Credit Score</td>
                        <td align="center" class="resultHeading">Base Rate</td>
                        <td align="center" class="resultHeading">Max Rate</td>
                      </tr>
                      <apex:repeat value="{!listInterestRate}" var="r">
                        <tr>
                          <td align="center" class="otherOtherResult">
                            <apex:outputText value="{!r.Profile__c}" />
                          </td>
                          <td align="center" class="otherOtherResultValue">
                            <apex:outputText value="{!r.Rate_1__c}" />%</td>
                          <td align="center" class="otherOtherResultValue">
                            <apex:outputText value="{!r.Rate_2__c}" />%</td>
                        </tr>
                      </apex:repeat>
                    </table>
                </td>
                </tr>
            </table>
        </apex:form>
        <apex:image url="{!$Resource.Affordable}" height="377" width="668"/>  
        <!--apex:form id="interestForm" >
            <div class="referenceTable">
              <table>
                    <tr>
                        <td width="30%" valign="top">
                          <table width="100%" class="tableDetails">
                            <tr>
                              <td align="center" class="otherOtherResultValue">Interest Rate Table</td>
                            </tr>
                            <tr>
                              <td>
                                <table width="100%">
                                  <tr>
                                    <td align="center" class="resultHeading">Client Tier</td>
                                    <td align="center" class="resultHeading">Base Rate</td>
                                    <td align="center" class="resultHeading">Max Rate</td>
                                  </tr>
                                  <apex:repeat value="{!listInterestRate}" var="r">
                                    <tr>
                                      <td align="center" class="otherOtherResult">
                                        <apex:outputText value="{!r.Profile__c}" />
                                      </td>
                                      <td align="center" class="otherOtherResultValue">
                                        <apex:outputText value="{!r.Rate_1__c}" />%</td>
                                      <td align="center" class="otherOtherResultValue">
                                        <apex:outputText value="{!r.Rate_2__c}" />%</td>
                                    </tr>
                                  </apex:repeat>
                                </table>
                              </td>
                            </tr>
                          </table>
                        </td>
                        <td width="30%" valign="top">
                          <table width="100%" class="tableDetails">
                            <tr>
                              <td align="center" class="otherOtherResultValue">Vehicle Age Rate Modifiers</td>
                            </tr>
                            <tr>
                              <td>
                                <table width="100%">
                                  <tr>
                                    <td align="center" class="resultHeading">Client Tier</td>
                                    <td align="center" class="resultHeading">0 - 2 yeras</td>
                                    <td align="center" class="resultHeading">3 - 7 years</td>
                                    <td align="center" class="resultHeading">+8 years</td>
                                  </tr>
                                  <tr>
                                    <td align="center" class="otherOtherResult">Premium</td>
                                    <td align="center" class="otherOtherResultValue">-</td>
                                    <td align="center" class="otherOtherResultValue">+1%</td>
                                    <td align="center" class="otherOtherResultValue">+2%</td>
                                  </tr>
                                  <tr>
                                    <td align="center" class="otherOtherResult">Classic</td>
                                    <td align="center" class="otherOtherResultValue">-</td>
                                    <td align="center" class="otherOtherResultValue">-</td>
                                    <td align="center" class="otherOtherResultValue">+2%</td>
                                  </tr>
                                  <tr>
                                    <td align="center" class="otherOtherResult">Standard</td>
                                    <td align="center" class="otherOtherResultValue">-</td>
                                    <td align="center" class="otherOtherResultValue">-</td>
                                    <td align="center" class="otherOtherResultValue">+2%</td>
                                  </tr>
                                </table>
                              </td>
                            </tr>
                          </table>
                        </td>
                        <td width="40%" valign="top">
                            <table width="100%" class="tableDetails">
                                <tr>
                                    <td align="center" class="otherOtherResultValue">Up front Loan Fees Table</td>
                                </tr>
                                <tr>
                                    <td>
                                        <table width="100%">
                                            <tr>
                                                <td align="center" class="resultHeading">% Min Interest Rate</td>
                                                <td align="center" class="resultHeading">% Max Interest Rate</td>
                                                <td align="center" class="resultHeading">Max Lend</td>
                                                <td align="center" class="resultHeading">Establishment Fee</td>
                                                <td align="center" class="resultHeading">Risk Fee % Of NAF</td>
                                                <td align="center" class="resultHeading">Broker Commission</td>
                                            </tr>
                                            <apex:repeat value="{!listUpfrontLoanFees}" var="r" >
                                                <tr>
                                                    <td align="center" class="otherOtherResult"><apex:outputField value="{!r.Min_Interest_Rate__c}"/></td>
                                                    <td align="center" class="otherOtherResultValue"><apex:outputField value="{!r.Max_Interest_Rate__c}"/></td>
                                                    <td align="center" class="otherOtherResultValue"><apex:outputField value="{!r.Max_Lend__c}"/></td>
                                                    <td align="center" class="otherOtherResultValue"><apex:outputField value="{!r.Establishment_Fee__c}"/></td>
                                                    <td align="center" class="otherOtherResultValue"><apex:outputField value="{!r.Risk_Fee_Interest_Rate_Of_NAF__c}"/></td>
                                                    <td align="center" class="otherOtherResultValue"><apex:outputField value="{!r.Comm__c}"/></td>
                                                </tr>
                                            </apex:repeat>
                                        </table>
                                    </td>
                                </tr>
                            </table>        
                        </td>
                    </tr>
                </table>
            </div>
            <p>&nbsp;</p>
        </apex:form>-->
    </div>
    <apex:outputField value="{!o.Application__r.Application_Quoting__c}" rendered="false" />
    <apex:outputField value="{!o.Account__c}" rendered="false" />
    <apex:outputField value="{!o.Loan_Product__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Title_1__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.First_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Last_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Email_Address__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Phone__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Mobile__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Email__c}" rendered="false" />
    <apex:outputField value="{!o.First_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Last_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Account__r.FirstName}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Status__c}" rendered="false" />
    <apex:outputField value="{!o.Application_AssetDetail__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.State__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Type_of_Asset__c}" rendered="false" />
    <!--Jesus Mora 2020-10-12 start-->
    <apex:outputField value="{!o.Application__r.Mode_of_Employment_1__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Application_Type__c}" rendered="false" />
    <apex:outputField value="{!o.Application_AssetDetail__r.Engine_No__c}" rendered="false" />
    <!--Jesus Mora 2020-10-12 end-->
</apex:page>