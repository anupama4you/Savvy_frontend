<apex:page docType="html-5.0" standardController="Custom_Opportunity__c" extensions="MacquarieConsumerExtension" sidebar="false" showHeader="true" id="MacquarieConsumer">
    <apex:variable value="{!Custom_Opportunity__c}" var="o" />
    <!-- Partner Portal Styles -->
    <apex:outputPanel rendered="{!isBrokerPartnerUser}">
      <style type="text/css">
        html .brandQuaternaryBgr,
        .titleDiv {
          background: #ffffff !important;
        }
    
        .bPageBlock {
          border: 1px solid white !important;
        }
      </style>
    </apex:outputPanel>
    <apex:stylesheet value="{! $Resource.QuotingCalculatorCSS }"/>
    <style type="text/css">
        .titleDiv {
            width: 100%;
            height: 43px;
            font-size: 1.0rem;
        }
        .logo {
            float: right;
            width: 60%;
        }
        .calculatorInput {
            padding-bottom: 20px;
            background: #f8f8f8;
            border: 1px solid #ddd;
        }
        .divTitle {
            background-color: #ddd;
            padding-top: 2px;
            padding-bottom: 2px;
            padding-left: 20px;
            text-transform: uppercase;
            border: 1px solid #ddd;
        }
        #leftTables {
            display: inline-block;
            float: left;
            width: 28%;
            padding-left: 20px;
        }
        #rightTables {
            display: inline-block;
            width: 70%;
        }
        #vehicleTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
        }
        #vehicleDetails {
            width: 95%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        #insuranceTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
        }
        #insuranceProduct {
            width: 95%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 0px;
            padding-bottom: 10px;
        }
        #financeTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position:relative;
            padding: 6px;
            top: 17px;
        }
        #financeDetails {
            width: 95%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 10px;
            padding-bottom: 10px;
        }        
        .calculateButtons:hover {
            background: rgb(125,126,125) !important; /* Old browsers */
            background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 41%) !important; /* FF3.6-15 */
            background: -webkit-linear-gradient(top,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 41%) !important; /* Chrome10-25,Safari5.1-6 */
            background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 41%) !important; /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important; /* IE6-9 */
        }
        #commissionPanel {
            background: #f8f8f8;
            border: 1px solid #ddd;
        }
        #commissionTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
            margin-left: 20px;
        }
        #commission {
            width: 96%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 20px;
            padding-bottom: 20px;
            margin-left: 20px;
            margin-bottom: 20px;
        }
        #repaymentPanel {
            background: #f8f8f8;
            border: 1px solid #ddd;
        }
        #repaymentTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
            margin-left: 20px;
        }
        #repayment {
            width: 96%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 20px;
            padding-bottom: 20px;
            margin-left: 20px;
            margin-bottom: 20px;
        }
        .inTableTitle {
            font-weight: bold;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        .calcInput {
            border: 1px solid #e0e0e0;
            padding: 0.15em;
            min-width: 173px;
        }
        .calcInput2 {
            border: 1px solid #e0e0e0;
            padding: 0.15em;
            max-width: 70px;
        }
        .calcInputSmall {
            border: 1px solid #e0e0e0;
            padding: 0.15em;
            min-width: 50px;
            max-width: 50px;
        }
        .selectList {
            border: 1px solid #e0e0e0;
            padding: 0.15em;
            width:182px;
        }
        .defaultInsurance {
            text-align: center;
            width: 25%;
        }
        .vehicleColumn {
            width: 25%;
        }
        .insuranceColumn {
            width: 25%;
        }
        .financeColumn {
            width: 50%;
        }
        .commissionLabel {
            width: 8%;
            font-weight: bold;
        }
        .commissionCotent {
            width: 17%;
            font-weight: bold;
        }
        .repayColumn {
            width: 12.5%;
            font-weight: bold;
        }
        .calcLabel {
            font-weight: 500;
        }
        .baseRateColumn {
            padding: 0.3rem;
        }
        .monthlyFeeLabel {
            width: 5%;
            font-weight: bold;
        }
        .monthlyFeeContent {
            width: 20%;
            font-weight: bold;
        }
        .referenceTable {
            
        }
        .referenceTitle {
            padding: 10px;
        }
        .tableDetails {
            width: 95%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        .titleTableTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
        }
        .resultValue {
            font-weight: bold;
        }
        .buttonPanel {
            float: right;
            text-align: right;
        }
        
        /*Created By: Phil Fang | Date: March 6, 2017 | Description: Styling for ERIC API integration*/
        .acceptQuoteButtons {
            padding: 6px 7px !important;
            color: #fff !important;
            font-size: 11px !important;
            outline: none !important;
        
            background: rgb(125,126,125) !important; 
            background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important;
            
            background: -webkit-linear-gradient(top,  rgba(0,77,0,1) 0%,rgba(0,102,0,1) 100%) !important;
            
            /*original*/
            /*background: -webkit-linear-gradient(top,  rgba(51,126,88,1) 0%,rgba(44,112,66,1) 100%) !important;*/
            
            /*background: -webkit-linear-gradient(top,  rgba(62,151,106,1) 0%,rgba(51,125,88,1) 100%) !important;*/
    
            margin: 0px !important;
        }
        
        .acceptQuoteButtonsClicked {
            padding: 6px 7px !important;
            color: #fff !important;
            font-size: 11px !important;
            outline: none !important;
        
            background: rgb(125,126,125) !important; 
            background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important;
            
            background: -webkit-linear-gradient(top,  rgba(0,153,0,1) 0%,rgba(0,179,0,1) 100%) !important;
            
            /*background: -webkit-linear-gradient(top,  rgba(62,151,106,1) 0%,rgba(51,125,88,1) 100%) !important;*/
    
            margin: 0px !important;
        }
        
        .decQuoteButtons {
            padding: 6px 7px !important;
            color: #fff !important;
            font-size: 11px !important;
            outline: none !important;
           
            background: rgb(125,126,125) !important;
            background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important; 
            
            background: -webkit-linear-gradient(top,  rgba(168,0,0,1) 0%, rgba(219,0,0,1) 100%) !important; Chrome10-25,Safari5.1-6
            
            /*background: -webkit-linear-gradient(top,  rgba(235,74,93,1) 0%, rgba(203,57,74,1) 100%) !important; Chrome10-25,Safari5.1-6*/
            
            /*background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important;  */
            /* filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important;  */
            
            margin: 0px !important;
        }
        
        .decQuoteButtonsClicked {
            padding: 6px 7px !important;
            color: #fff !important;
            font-size: 11px !important;
            outline: none !important;
           
            background: rgb(125,126,125) !important;
            background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important; 
            
            background: -webkit-linear-gradient(top,  rgba(245,0,0,1) 0%, rgba(255,66,66,1) 100%) !important; Chrome10-25,Safari5.1-6
            
            /*background: -webkit-linear-gradient(top,  rgba(235,74,93,1) 0%, rgba(203,57,74,1) 100%) !important; Chrome10-25,Safari5.1-6*/
            
            /*background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important;  */
            /* filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important;  */
            
            margin: 0px !important;
        }
        
        .buyPolicyButtons {
            padding: 6px 7px !important;
            color: #fff !important;
            font-size: 14px !important;
            outline: none !important;
           
            background: rgb(125,126,125) !important;
            background: -moz-linear-gradient(top,  rgba(125,126,125,1) 0%, rgba(14,14,14,1) 100%) !important; 
            
            background: -webkit-linear-gradient(top,  rgba(0,0,0,1) 0%, rgba(191,191,191,1) 100%) !important; Chrome10-25,Safari5.1-6

            
            /*color test 2 okay*/
            /*background: -webkit-linear-gradient(top,  rgba(66,161,255,1) 0%, rgba(117,186,255,1) 100%) !important; Chrome10-25,Safari5.1-6*/
            
            /*original*/
            /*background: -webkit-linear-gradient(top,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important;*/
            background: linear-gradient(to bottom,  rgba(125,126,125,1) 0%,rgba(14,14,14,1) 100%) !important; 
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7d7e7d', endColorstr='#0e0e0e',GradientType=0 ) !important; 
            
            float: right;
            margin-top: 10px !important;
            margin-right: 48px !important;
            height:45px;
            width: 150px;
       
        }
        .totalInsuranceLabel {
            width: 5%;
            font-weight: bold;
        }
        .totalInsuranceBorder{
            border-top: 2px solid black !important;
        }
        #mcqQuoteTab {
            border: 1px solid #ddd;
            border-bottom: transparent;
            display: inline-block;
            background-color: #fff;
            position: relative;
            padding: 6px;
            top: 17px;
        }
        #mcqQuoteDetails {
            width: 95%;
            background: white;
            border: 1px solid #ddd;
            margin-top: 15px;
            padding: 2px;
            padding-left: 20px;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        .mcqQuoteColumn {
            width: 25%;
        }
        
        .row:after {
            display: table;
            content: "";
            clear: both;
        }

        .main-content {
          margin-left: auto;
          width: 86%;
        }
    </style>
    
    <c:sidebarV2 oppId="{!o.Id}" appId="{!o.Application__c}" showLenders="true" rendered="{!NOT(isBrokerPartnerUser)}" />
    <div id="mainContent" class="{!IF(NOT(isBrokerPartnerUser),'main-content','')}">
        <!-- <apex:sectionHeader /> -->
        <!-- <apex:variable value="{!Custom_Opportunity__c}" var="o" /> -->
        <apex:form id="calcFormData">
            <apex:pageMessages id="pageMessage" />
            <!-- NWC -->
            <apex:actionFunction action="{!nationalWarrantyCalc}" name="nationalWarrantyCalc" reRender="realtimeNaf, netDeposit, pnlInsProd, pageMessage"
              oncomplete="nafRefresh()" />
            <apex:actionFunction action="{!calculateNWC}" name="calculateNWC" reRender="pnlNwc, NWCRetailPrice, NWCComission, pageMessage, nwcIncome_input, nwc_input, nwcTerm2, NWCPayment"
              oncomplete="nafRefresh()" status="stsProd" />
            <apex:actionFunction action="{!checkManuallyNWCPrice}" name="checkManuallyNWCPrice" reRender="pnlNwc, NWCRetailPrice, NWCComission, pageMessage, nwcIncome_input, nwc_input, nwcTerm2, NWCPayment"
              status="stsProd" />
            <!-- Send Quote -->
            <apex:actionFunction action="{!sendCustomerEmail1}" name="sendCustomerEmail1" reRender="pageMessage" status="stsSend1" oncomplete="sendCustomerEmail2();"/>
            <apex:actionFunction action="{!sendCustomerEmail2}" name="sendCustomerEmail2" status="stsSend2" reRender="pageMessage"/>
            <!-- End -->
            <apex:actionFunction action="{!realtimeNafCalc}" name="nafRefresh" reRender="realtimeNaf, netDeposit, totalInsurance, residualValue, maxDOF" />
            <apex:actionFunction action="{!applicationFeefCalc}" name="applicationFeefCalc" reRender="applicationFee, baseRate, maxRate, clientRate, realtimeNaf, netDeposit, totalInsurance, residualValue" oncomplete="baseRateRefresh();" />
            <apex:actionFunction action="{!baseRateCalc}" name="baseRateRefresh" reRender="baseRate, maxRate, clientRate, netDeposit, pageMessage, totalInsurance" status="stsQuote"/>
            <apex:actionFunction action="{!assetYearOption}" name="assetYearOption" reRender="calcFormData" />
            <apex:actionFunction action="{!clientRateValidate}" name="messageRefresh" reRender="pageMessage" />
            <apex:actionFunction action="{!validation}" name="consumerValidate" reRender="pageMessage" />
            <apex:actionFunction action="{!changeLoanProduct}" name="changeLoanProduct" reRender="productGoodsType, productGoodsSubType, loanFrequency, baseRate, clientRate, maxRate" oncomplete="" />
            <apex:actionFunction action="{!changeGoodsType}" name="changeGoodsType" reRender="productGoodsSubType, fldManufactureYear" status="stsQuote" oncomplete="baseRateRefresh();" />
            <apex:actionFunction action="{!resetResidualValues}" name="changeTypeValue" reRender="residualValue, residualValuePercentage" oncomplete="" />
            <div class="titleDiv">
                <h1>Macquarie Consumer for {!Custom_Opportunity__c.Name}</h1>
                <div class="buttonPanel">
                    <table>
                        <tr>
                            <td>
                                <apex:actionStatus startText="(Processing...)" id="stsQuote"  />
                                <apex:actionStatus startText="(Saving...)" id="stsSend1" />
                                <apex:actionStatus startText="(Sending...)" id="stsSend2" />&nbsp;&nbsp;&nbsp;
                                <!-- Get Message's test-->
                                <apex:commandButton styleClass="calculateButtons" value="Macquarie Application (Test)" action="{!macquarieApplicationTest}" status="stsQuote" rendered="{!paramActive}"/>
                                <apex:commandButton styleClass="calculateButtons" value="Macquarie quote (Test)" action="{!macquarieQuoteTest}" status="stsQuote" rendered="{!paramActive}"/>
                                <!-- Get Message's test-->
                                <apex:commandButton styleClass="calculateButtons" value="Macquarie Application" action="{!macquarieApplication}" status="stsQuote" rendered="{!IF(ISBLANK(mcqApplicationId) && !ISBLANK(mcqGrossPayment),true,false)}"/>
                                <apex:commandButton styleClass="calculateButtons" value="Macquarie quote" action="{!macquarieQuote}" status="stsQuote" rendered="{!IF(ISBLANK(mcqGrossPayment),true,false)}"/>
                                <!--Created By: Phil Fang | Date: March 6, 2017 | Description: Import Quote button-->
                                <!-- <apex:commandButton styleClass="calculateButtons" value="Import Quote" action="{!importQuote}"/> -->
                                
                                <apex:commandButton styleClass="calculateButtons" value="Calculate" action="{!calculate}" status="stsQuote" reRender="calcFormData"/>
                                <apex:commandButton styleClass="calculateButtons" value="Reset" action="{!reset}" status="stsQuote" reRender="calcFormData"/>
                                <apex:commandButton styleClass="calculateButtons" value="Save Quoting" action="{!saveQuoting}" status="stsQuote" reRender="calcFormData"/>
                                <apex:commandButton styleClass="calculateButtons" value="Save Pre-approval" action="{!savePreApproval}" status="stsQuote" reRender="calcFormData"/>
                                <apex:commandButton styleClass="calculateButtons" value="Save Amendment" action="{!saveAmendment}" status="stsQuote" reRender="calcFormData"/>
                                <apex:commandButton styleClass="calculateButtons" value="Save Formal Approval" action="{!saveFormalApproval}" status="stsQuote" reRender="calcFormData"/>
                                
                                <input name="DoAction" type="button" value="Send Quote" class="btn calculateButtons"
                                       onclick="sendCustomerEmail1();return false;"/>   
                                
                                <!--Created By: Phil Fang | Date: March 6, 2017 | Description: Create Quote button-->
                                <!-- <apex:commandButton styleClass="calculateButtons" value="Create Quote" onclick="popupwindow();"/> -->
                                
                            </td>
                            <td>
                                <apex:image url="{!$Resource.MacquarieLogo}" height="40" />
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="calculatorInput"  >
                <div class="divTitle">
                    <h3>Input</h3>
                </div>
                <div class="row">
                    <div id="leftTables">
                        <div id="financeTab"><h3>Finance Details</h3></div>
                        <table id="financeDetails">
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Loan Type" for="LoanType" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Loan Type" value="{!loanType}" multiselect="false" size="1" styleClass="selectList" id="LoanType"
                                                onchange="applicationFeefCalc()">
                                    <apex:selectOptions value="{!loanTypeOptions}" />
                                </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Loan Product" for="productLoanType" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Loan Type" value="{!productLoanType}" multiselect="false" size="1" styleClass="selectList" id="productLoanType"  onchange="changeLoanProduct()">
                                    <apex:selectOptions value="{!productLoanTypes}" />
                                </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                    <apex:outputLabel styleClass="calcLabel" value="Goods Type" for="productGoodsType" />
                                </td>
                                <td class="financeColumn">
                                    <apex:selectList label="Goods Type" value="{!productGoodsType}" multiselect="false" size="1" styleClass="selectList" id="productGoodsType"  onchange="changeGoodsType();">
                                        <apex:selectOptions value="{!productGoodsTypes}"/>
                                    </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                    <apex:outputLabel styleClass="calcLabel" value="Goods SubType" for="productGoodsSubType" />
                                </td>
                                <td class="financeColumn">
                                    <apex:selectList label="Goods Sub Type" value="{!productGoodsSubType}" multiselect="false" size="1" styleClass="selectList" id="productGoodsSubType">
                                        <apex:selectOptions value="{!productGoodsSubTypes}" />
                                        <apex:actionSupport event="onchange" action="{!baseRateCalc}" reRender="baseRate, clientRate, maxRate" />
                                    </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Loan Frequency" for="loanFrequency" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Loan frequency" value="{!loanFrequency}" multiselect="false" size="1" styleClass="selectList" id="loanFrequency">
                                    <apex:selectOptions value="{!loanFrequencies}" />
                                </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Car Price" for="carPrice" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="Car Price" value="{!carPrice}" html-placeholder="$" id="carPrice" styleClass="calcInput" onchange="baseRateRefresh();nafRefresh();" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Deposit" for="deposit" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="Deposit" value="{!deposit}" html-placeholder="$" id="deposit" styleClass="calcInput" onchange="baseRateRefresh();nafRefresh()" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Trade In" for="tradeIn" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="Trade In" value="{!tradeIn}" html-placeholder="$" id="tradeIn" styleClass="calcInput" onchange="baseRateRefresh();nafRefresh()" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Payout On Trade In" for="payoutOn" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="Payout On" value="{!payoutOn}" html-placeholder="$" id="payoutOn" styleClass="calcInput" onchange="baseRateRefresh();nafRefresh()" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Net Deposit" for="netDeposit" />
                                </td>
                                <td class="financeColumn">
                                <apex:outputText label="NAF" value="{0, number, $##,###,##0.00}" id="netDeposit" >
                                    <apex:param value="{!netDeposit}" />
                                </apex:outputText>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Application Fee" for="applicationFee" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="Application Fee" value="{!applicationFee}" html-placeholder="$" id="applicationFee" styleClass="calcInput" onchange="nafRefresh();" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                  <apex:outputLabel styleClass="calcLabel" value="DOF" for="dof" />
                                </td>
                                <td class="financeColumn">
                                    <apex:input type="number" html-step="0.01" label="DOF" value="{!dof}" html-placeholder="$" id="dof" styleClass="calcInput2" onchange="nafRefresh();" />
                                    <!-- <apex:outputPanel id="maxDof" layout="inline"> -->
                                       &nbsp;&nbsp;&nbsp;
                                      <apex:outputText value="Max. {0, number, $##,###,##0.00}" id="maxDOF">
                                        <apex:param value="{!maxDOF}" />
                                      </apex:outputText>
                                    <!-- </apex:outputPanel> -->
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="PPSR" for="ppsr" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="PPSR" value="{!ppsr}" html-placeholder="$" id="ppsr" styleClass="calcInput" onchange="nafRefresh();" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Type Value" for="selectedTypeValue" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectRadio value="{!selectedTypeValue}" layout="lineDirection" id="selectedTypeValue" onchange="changeTypeValue()">
                                    <apex:selectOptions value="{!options}"/>
                                </apex:selectRadio>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                    <apex:outputLabel styleClass="calcLabel" value="Residual Value (%)" for="residualValuePercentage" />
                                </td>
                                <td class="financeColumn">
                                    <apex:input type="number" html-step="0.01" label="Residual Value (%)" value="{!residualValuePercentage}" html-placeholder="%" id="residualValuePercentage" 
                                                styleClass="calcInput" onchange="nafRefresh();"/>
                                </td>
                                
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Residual Value" for="residualValue" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" html-step="0.01" label="Residual Value" value="{!residualValue}" html-placeholder="$" id="residualValue" styleClass="calcInput"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="inTableTitle">Loan Details</td>
                                <td class="financeColumn"></td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Term (months)" for="term" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" label="Term" value="{!term}" id="term" styleClass="calcInput" onchange="baseRateRefresh()" />
                                </td>
                            </tr>
                            <!-- <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Car Age" for="carAge" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" label="Car Age" value="{!carAge}" id="carAge" styleClass="calcInput" onchange="baseRateRefresh()"/>
                                </td>
                            </tr> -->
                            <tr>
                                <td class="financeColumn">
                                    <apex:outputLabel styleClass="calcLabel" value="Asset Year" for="fldManufactureYear" />
                                </td>
                                <td class="financeColumn">
                                    <apex:selectList label="Year of Manufacture" value="{!manufactureYear}" multiselect="false" size="1" styleClass="selectList" id="fldManufactureYear" onchange="baseRateRefresh()" >
                                        <apex:selectOptions value="{!manufactureYearOptions}" />
                                    </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Property Owner" for="proOwner" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Property Owner" value="{!propertyOwner}" multiselect="false" size="1" styleClass="selectList" id="proOwner" onchange="baseRateRefresh()" >
                                    <apex:selectOption itemLabel="No" itemValue="N"  />
                                    <apex:selectOption itemLabel="Yes" itemValue="Y"  />
                                </apex:selectList>
                                </td>
                            </tr>
                            <!-- <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="LTV" for="ltvValue" />
                                </td>
                                <td class="financeColumn">
                                <apex:input type="number" label="LTV" value="{!ltv}" id="ltvValue" styleClass="calcInput" onchange="baseRateRefresh()" />
                                </td>
                            </tr> -->
                            <!-- <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Motor Cycles" for="motorCycles" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Motor Cycles" value="{!motorCycles}" multiselect="false" size="1" styleClass="selectList" id="motorCycles" onchange="baseRateRefresh()" >
                                    <apex:selectOptions value="{!yesNoOptions}" />
                                </apex:selectList>
                                </td>
                            </tr> -->
                            <!-- <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Caravan/Campervans" for="caravanCampervans" />
                                </td>
                                <td class="financeColumn">
                                    <apex:selectList label="Caravan/Campervans" value="{!caravanCampervans}" multiselect="false" size="1" styleClass="selectList" id="caravanCampervans" onchange="baseRateRefresh()" >
                                    <apex:selectOptions value="{!yesNoOptions}" />
                                </apex:selectList>
                                </td>
                            </tr> -->
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Private Sales" for="privateSales" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Private Sales" value="{!privateSales}" multiselect="false" size="1" styleClass="selectList" id="privateSales" onchange="applicationFeefCalc()" >
                                    <apex:selectOption itemLabel="No" itemValue="N"  />
                                    <apex:selectOption itemLabel="Yes" itemValue="Y"  />
                                </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="LTV" for="ltv" />
                                </td>
                                <td class="financeColumn">
                                <apex:inputText label="LTV" value="{!ltv}" html-placeholder="%" id="ltv" onchange="baseRateRefresh()"  styleClass="calcInput"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Payment" for="paymentType" />
                                </td>
                                <td class="financeColumn">
                                <apex:selectList label="Payment" value="{!paymentType}" multiselect="false" size="1" styleClass="selectList" id="paymentType" onchange="consumerValidate()" >
                                    <apex:selectOptions value="{!paymentTypes}" />
                                </apex:selectList>
                                </td>
                            </tr>
                            <tr>
                                <td class="monthlyFeeLabel">
                                    <apex:outputLabel value="Monthly Fee" for="monthlyFee" />
                                </td>
                                <td class="monthlyFeeContent">
                                    <apex:input type="number" html-step="0.01" label="Monthly Fee" value="{!monthlyFee}" html-placeholder="$" id="monthlyFee" styleClass="calcInput" />
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Base Rate" for="baseRate" />
                                </td>
                                <td class="financeColumn">
                                    <apex:outputText label="Base Rate" value="{0, number, ##,###,##0.00%}" id="baseRate" >
                                        <apex:param value="{!baseRate/100}" />
                                    </apex:outputText>
                                </td>
                            </tr>
                            <tr>
                                <td class="financeColumn">
                                <apex:outputLabel styleClass="calcLabel" value="NAF" for="realtimeNaf" />
                                </td>
                                <td class="financeColumn"><strong>
                                <apex:outputText label="NAF" value="{0, number, $##,###,##0.00}" id="realtimeNaf" >
                                    <apex:param value="{!realtimeNaf}" />
                                </apex:outputText></strong>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div id="rightTables">
                        <c:QuotingCommissionResults qext="{!quotingExt}" />

                        <div id="mcqQuoteTab"><h3>Macquarie Details</h3></div>
                        <table id="mcqQuoteDetails">
                            <tr>
                                <td class="mcqQuoteColumn">
                                <apex:outputLabel styleClass="calcLabel" value="Macquarie user" for="mcqUser" />
                                </td>
                                <td class="mcqQuoteColumn">
                                    <apex:selectList label="Macquarie user" value="{!mcqUser}" multiselect="false" size="1" styleClass="selectList" id="mcqUser" >
                                        <apex:selectOptions value="{!mcqUserOptions}" />
                                    </apex:selectList>
                                </td>
                                <td>
                                    <apex:outputLink value="{!$Page.macquarieSettings}?id={!o.Id}">Settings</apex:outputLink>
                                </td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td>
                                    <apex:outputLabel style="display:inline-block;" value="Gross payment" for="grossPayment" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Gross payment" value="{0, number, $##,###,##0.00}" id="grossPayment" >
                                        <apex:param value="{!mcqGrossPayment}" />
                                    </apex:outputText>
                                </td>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="Payment frequency" for="paymentFrequency" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Payment frequency" value="{!mcqPaymentFrequency}" id="paymentFrequency" />
                                </td>
                            </tr>
                            <tr>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="Customer rate" for="customerRate" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Customer rate" value="{0, number, ##,###,##0.00%}" id="customerRate" >
                                        <apex:param value="{!mcqCustomerRate/100}" />
                                    </apex:outputText>
                                </td>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="Last Macquarie Quote" for="lastMacquarieQuote" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Message" value="{!mcqLastResponseQuote}" id="lastMacquarieQuote" />
                                </td>
                            </tr>
                            <tr>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="Message" for="mcqMessage" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Message" value="{!mcqMessageQuote}" id="mcqMessage" />
                                </td>
                                <td>&nbsp;</td>
                                <td>&nbsp;</td>
                            </tr>
                            <tr>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="ApplicationId" for="ApplicationId" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Message" value="{!mcqApplicationId}" id="ApplicationId" />
                                </td>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="Last Macquarie Application" for="lastMacquarieApp" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Message" value="{!mcqLastResponseApplication}" id="lastMacquarieApp" />
                                </td>
                            </tr>
                            <tr>
                                <td class="mcqQuoteColumn">
                                    <apex:outputLabel style="display:inline-block;" value="Message" for="mcqMessageAppId" />
                                </td>
                                <td class="resultValue">
                                    <apex:outputText label="Message" value="{!mcqMessageAppId}" id="mcqMessageAppId" />
                                </td>
                                <td>&nbsp;</td>
                                <td><apex:commandButton styleClass="calculateButtons" value="Restart Quote" action="{!macquarieQuoteRestart}" status="stsQuote" rendered="{!IF(ISBLANK(mcqApplicationId) && !ISBLANK(mcqGrossPayment),true,false)}"/></td>
                            </tr>
                        </table>

                        <c:InsuranceProductForm qext="{!quotingExt}" formId="calcFormData" id="pnlInsProd" />
                        <br/>
                        <c:ProtectionQuestions lead="{!o.Lead__r}" rendered="false" />
                    </div>
                </div>
            </div>
        </apex:form>
        <br/>
        <apex:form id="referenceForm" >
            <div class="referenceTable">
                <apex:pageBlock >
                    <apex:pageBlockTable value="{!rateList}" var="r">
                        <apex:facet name="header">Macquarie Consumer Max. Rates</apex:facet>
                        <apex:column value="{!r.Product__c}" />
                        <apex:column value="{!r.Profile__c}" />
                        <apex:column value="{!r.Year__c}" />
                        <apex:column value="{!r.R1__c}" />
                        <apex:column value="{!r.R2__c}" />
                        <apex:column value="{!r.R3__c}" />
                        <!-- <apex:column value="{!r.R4__c}" /> -->
                    </apex:pageBlockTable>
                </apex:pageBlock>
            </div>
        </apex:form>
    </div>
    <apex:outputField value="{!o.Application__r.Application_Quoting__c}" rendered="false" />
    <apex:outputField value="{!o.Account__c}" rendered="false" />
    <apex:outputField value="{!o.Loan_Product__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Title_1__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.First_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Last_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Email_Address__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Phone__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Mobile__c}" rendered="false" />
    <apex:outputField value="{!o.Owner_Email__c}" rendered="false" />
    <apex:outputField value="{!o.First_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Last_Name__c}" rendered="false" />
    <apex:outputField value="{!o.Account__r.FirstName}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Status__c}" rendered="false" />
    <apex:outputField value="{!o.Application_AssetDetail__c}" rendered="false" />
    <!-- HJ - NWC Calculator  - 11-07-2018 - I -->
    <apex:outputField value="{!o.Application__r.State__c}" rendered="false" />
    <apex:outputField value="{!o.Application__r.Type_of_Asset__c}" rendered="false" />
    <!-- HJ - NWC Calculator  - 11-07-2018 - F -->
    <apex:outputField value="{!o.Application_AssetDetail__r.Year__c}" rendered="false" />
    <apex:outputField value="{!o.Application_AssetDetail__r.LVR__c}" rendered="false" />
</apex:page>